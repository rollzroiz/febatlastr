/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["node_modules_faustjs_core_dist_mjs_server_auth_token_js"],{

/***/ "./node_modules/lodash/isNumber.js":
/*!*****************************************!*\
  !*** ./node_modules/lodash/isNumber.js ***!
  \*****************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

eval("var baseGetTag = __webpack_require__(/*! ./_baseGetTag */ \"./node_modules/lodash/_baseGetTag.js\"),\n    isObjectLike = __webpack_require__(/*! ./isObjectLike */ \"./node_modules/lodash/isObjectLike.js\");\n\n/** `Object#toString` result references. */\nvar numberTag = '[object Number]';\n\n/**\n * Checks if `value` is classified as a `Number` primitive or object.\n *\n * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are\n * classified as numbers, use the `_.isFinite` method.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a number, else `false`.\n * @example\n *\n * _.isNumber(3);\n * // => true\n *\n * _.isNumber(Number.MIN_VALUE);\n * // => true\n *\n * _.isNumber(Infinity);\n * // => true\n *\n * _.isNumber('3');\n * // => false\n */\nfunction isNumber(value) {\n  return typeof value == 'number' ||\n    (isObjectLike(value) && baseGetTag(value) == numberTag);\n}\n\nmodule.exports = isNumber;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvbG9kYXNoL2lzTnVtYmVyLmpzLmpzIiwibWFwcGluZ3MiOiJBQUFBLGlCQUFpQixtQkFBTyxDQUFDLDJEQUFlO0FBQ3hDLG1CQUFtQixtQkFBTyxDQUFDLDZEQUFnQjs7QUFFM0M7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsR0FBRztBQUNkLGFBQWEsU0FBUztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL2xvZGFzaC9pc051bWJlci5qcz9jYTM1Il0sInNvdXJjZXNDb250ZW50IjpbInZhciBiYXNlR2V0VGFnID0gcmVxdWlyZSgnLi9fYmFzZUdldFRhZycpLFxuICAgIGlzT2JqZWN0TGlrZSA9IHJlcXVpcmUoJy4vaXNPYmplY3RMaWtlJyk7XG5cbi8qKiBgT2JqZWN0I3RvU3RyaW5nYCByZXN1bHQgcmVmZXJlbmNlcy4gKi9cbnZhciBudW1iZXJUYWcgPSAnW29iamVjdCBOdW1iZXJdJztcblxuLyoqXG4gKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGEgYE51bWJlcmAgcHJpbWl0aXZlIG9yIG9iamVjdC5cbiAqXG4gKiAqKk5vdGU6KiogVG8gZXhjbHVkZSBgSW5maW5pdHlgLCBgLUluZmluaXR5YCwgYW5kIGBOYU5gLCB3aGljaCBhcmVcbiAqIGNsYXNzaWZpZWQgYXMgbnVtYmVycywgdXNlIHRoZSBgXy5pc0Zpbml0ZWAgbWV0aG9kLlxuICpcbiAqIEBzdGF0aWNcbiAqIEBtZW1iZXJPZiBfXG4gKiBAc2luY2UgMC4xLjBcbiAqIEBjYXRlZ29yeSBMYW5nXG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgbnVtYmVyLCBlbHNlIGBmYWxzZWAuXG4gKiBAZXhhbXBsZVxuICpcbiAqIF8uaXNOdW1iZXIoMyk7XG4gKiAvLyA9PiB0cnVlXG4gKlxuICogXy5pc051bWJlcihOdW1iZXIuTUlOX1ZBTFVFKTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzTnVtYmVyKEluZmluaXR5KTtcbiAqIC8vID0+IHRydWVcbiAqXG4gKiBfLmlzTnVtYmVyKCczJyk7XG4gKiAvLyA9PiBmYWxzZVxuICovXG5mdW5jdGlvbiBpc051bWJlcih2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdudW1iZXInIHx8XG4gICAgKGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgYmFzZUdldFRhZyh2YWx1ZSkgPT0gbnVtYmVyVGFnKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBpc051bWJlcjtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/lodash/isNumber.js\n");

/***/ }),

/***/ "./node_modules/@faustjs/core/dist/mjs/server/auth/token.js":
/*!******************************************************************!*\
  !*** ./node_modules/@faustjs/core/dist/mjs/server/auth/token.js ***!
  \******************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"OAuth\": function() { return /* binding */ OAuth; }\n/* harmony export */ });\n/* harmony import */ var isomorphic_fetch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! isomorphic-fetch */ \"./node_modules/isomorphic-fetch/fetch-npm-browserify.js\");\n/* harmony import */ var _config_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../config/index.js */ \"./node_modules/@faustjs/core/dist/mjs/config/index.js\");\n/* harmony import */ var lodash_isNil_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash/isNil.js */ \"./node_modules/lodash/isNil.js\");\n/* harmony import */ var lodash_isString_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash/isString.js */ \"./node_modules/lodash/isString.js\");\n/* harmony import */ var lodash_isNumber_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! lodash/isNumber.js */ \"./node_modules/lodash/isNumber.js\");\n/* harmony import */ var _utils_index_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/index.js */ \"./node_modules/@faustjs/core/dist/mjs/utils/index.js\");\n\n\n\n\n\n\nclass OAuth {\n    cookies;\n    tokenKey;\n    constructor(cookies) {\n        this.cookies = cookies;\n        this.tokenKey = `${(0,_config_index_js__WEBPACK_IMPORTED_MODULE_1__.config)().wpUrl}-rt`;\n    }\n    getRefreshToken() {\n        return this.cookies.getCookie(this.tokenKey);\n    }\n    setRefreshToken(token, expires) {\n        if (!lodash_isString_js__WEBPACK_IMPORTED_MODULE_3__(token) || token.length === 0) {\n            this.cookies.removeCookie(this.tokenKey);\n        }\n        let maxAge = 2592000;\n        let expiresIn;\n        if (lodash_isNumber_js__WEBPACK_IMPORTED_MODULE_4__(expires)) {\n            expiresIn = new Date(expires * 1000);\n            maxAge = undefined;\n        }\n        this.cookies.setCookie(this.tokenKey, token, {\n            expires: expiresIn,\n            maxAge,\n            path: '/',\n            sameSite: 'strict',\n            secure: true,\n            httpOnly: true,\n        });\n    }\n    async fetch(code) {\n        const { wpUrl, apiClientSecret } = (0,_config_index_js__WEBPACK_IMPORTED_MODULE_1__.config)();\n        if (!apiClientSecret) {\n            throw new Error('The apiClientSecret must be specified to use the auth middleware');\n        }\n        let response = await fetch(`${wpUrl}/?rest_route=/faustwp/v1/authorize`, {\n            headers: {\n                'Content-Type': 'application/json',\n                'x-faustwp-secret': apiClientSecret,\n            },\n            method: 'POST',\n            body: JSON.stringify({\n                code,\n                refreshToken: this.getRefreshToken(),\n            }),\n        });\n        if (response.status === 404) {\n            // Check for the deprecated authorize endpoint.\n            response = await fetch(`${wpUrl}/?rest_route=/wpac/v1/authorize`, {\n                headers: {\n                    'Content-Type': 'application/json',\n                    'x-wpe-headless-secret': apiClientSecret,\n                },\n                method: 'POST',\n                body: JSON.stringify({\n                    code,\n                    refreshToken: this.getRefreshToken(),\n                }),\n            });\n            if (response.status !== 404) {\n                (0,_utils_index_js__WEBPACK_IMPORTED_MODULE_5__.log)('Authentication and post previews will soon be incompatible with ' +\n                    'your version of the FaustWP plugin. Please update to the latest' +\n                    ' version.');\n            }\n        }\n        const result = await response.json();\n        if (!response.ok) {\n            return {\n                error: true,\n                response,\n                result,\n            };\n        }\n        return result;\n    }\n    // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n    isOAuthTokens(value) {\n        const castedValue = value;\n        return (!lodash_isNil_js__WEBPACK_IMPORTED_MODULE_2__(castedValue) &&\n            lodash_isString_js__WEBPACK_IMPORTED_MODULE_3__(castedValue.accessToken) &&\n            lodash_isString_js__WEBPACK_IMPORTED_MODULE_3__(castedValue.refreshToken) &&\n            lodash_isNumber_js__WEBPACK_IMPORTED_MODULE_4__(castedValue.accessTokenExpiration) &&\n            lodash_isNumber_js__WEBPACK_IMPORTED_MODULE_4__(castedValue.refreshTokenExpiration));\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQGZhdXN0anMvY29yZS9kaXN0L21qcy9zZXJ2ZXIvYXV0aC90b2tlbi5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQTBCO0FBQ3FCO0FBQ1g7QUFDTTtBQUNBO0FBQ0M7QUFDcEM7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQix3REFBTSxTQUFTO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLCtDQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSwrQ0FBUTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsZ0JBQWdCLHlCQUF5QixFQUFFLHdEQUFNO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxNQUFNO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLHNDQUFzQyxNQUFNO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQSxnQkFBZ0Isb0RBQUc7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiw0Q0FBSztBQUN0QixZQUFZLCtDQUFRO0FBQ3BCLFlBQVksK0NBQVE7QUFDcEIsWUFBWSwrQ0FBUTtBQUNwQixZQUFZLCtDQUFRO0FBQ3BCO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL0BmYXVzdGpzL2NvcmUvZGlzdC9tanMvc2VydmVyL2F1dGgvdG9rZW4uanM/NzExOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJ2lzb21vcnBoaWMtZmV0Y2gnO1xuaW1wb3J0IHsgY29uZmlnIH0gZnJvbSAnLi4vLi4vY29uZmlnL2luZGV4LmpzJztcbmltcG9ydCBpc05pbCBmcm9tICdsb2Rhc2gvaXNOaWwuanMnO1xuaW1wb3J0IGlzU3RyaW5nIGZyb20gJ2xvZGFzaC9pc1N0cmluZy5qcyc7XG5pbXBvcnQgaXNOdW1iZXIgZnJvbSAnbG9kYXNoL2lzTnVtYmVyLmpzJztcbmltcG9ydCB7IGxvZyB9IGZyb20gJy4uLy4uL3V0aWxzL2luZGV4LmpzJztcbmV4cG9ydCBjbGFzcyBPQXV0aCB7XG4gICAgY29va2llcztcbiAgICB0b2tlbktleTtcbiAgICBjb25zdHJ1Y3Rvcihjb29raWVzKSB7XG4gICAgICAgIHRoaXMuY29va2llcyA9IGNvb2tpZXM7XG4gICAgICAgIHRoaXMudG9rZW5LZXkgPSBgJHtjb25maWcoKS53cFVybH0tcnRgO1xuICAgIH1cbiAgICBnZXRSZWZyZXNoVG9rZW4oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvb2tpZXMuZ2V0Q29va2llKHRoaXMudG9rZW5LZXkpO1xuICAgIH1cbiAgICBzZXRSZWZyZXNoVG9rZW4odG9rZW4sIGV4cGlyZXMpIHtcbiAgICAgICAgaWYgKCFpc1N0cmluZyh0b2tlbikgfHwgdG9rZW4ubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmNvb2tpZXMucmVtb3ZlQ29va2llKHRoaXMudG9rZW5LZXkpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBtYXhBZ2UgPSAyNTkyMDAwO1xuICAgICAgICBsZXQgZXhwaXJlc0luO1xuICAgICAgICBpZiAoaXNOdW1iZXIoZXhwaXJlcykpIHtcbiAgICAgICAgICAgIGV4cGlyZXNJbiA9IG5ldyBEYXRlKGV4cGlyZXMgKiAxMDAwKTtcbiAgICAgICAgICAgIG1heEFnZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvb2tpZXMuc2V0Q29va2llKHRoaXMudG9rZW5LZXksIHRva2VuLCB7XG4gICAgICAgICAgICBleHBpcmVzOiBleHBpcmVzSW4sXG4gICAgICAgICAgICBtYXhBZ2UsXG4gICAgICAgICAgICBwYXRoOiAnLycsXG4gICAgICAgICAgICBzYW1lU2l0ZTogJ3N0cmljdCcsXG4gICAgICAgICAgICBzZWN1cmU6IHRydWUsXG4gICAgICAgICAgICBodHRwT25seTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGFzeW5jIGZldGNoKGNvZGUpIHtcbiAgICAgICAgY29uc3QgeyB3cFVybCwgYXBpQ2xpZW50U2VjcmV0IH0gPSBjb25maWcoKTtcbiAgICAgICAgaWYgKCFhcGlDbGllbnRTZWNyZXQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIGFwaUNsaWVudFNlY3JldCBtdXN0IGJlIHNwZWNpZmllZCB0byB1c2UgdGhlIGF1dGggbWlkZGxld2FyZScpO1xuICAgICAgICB9XG4gICAgICAgIGxldCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3dwVXJsfS8/cmVzdF9yb3V0ZT0vZmF1c3R3cC92MS9hdXRob3JpemVgLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAneC1mYXVzdHdwLXNlY3JldCc6IGFwaUNsaWVudFNlY3JldCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgICAgIHJlZnJlc2hUb2tlbjogdGhpcy5nZXRSZWZyZXNoVG9rZW4oKSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDA0KSB7XG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgdGhlIGRlcHJlY2F0ZWQgYXV0aG9yaXplIGVuZHBvaW50LlxuICAgICAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt3cFVybH0vP3Jlc3Rfcm91dGU9L3dwYWMvdjEvYXV0aG9yaXplYCwge1xuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICAgICAgJ3gtd3BlLWhlYWRsZXNzLXNlY3JldCc6IGFwaUNsaWVudFNlY3JldCxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgY29kZSxcbiAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFRva2VuOiB0aGlzLmdldFJlZnJlc2hUb2tlbigpLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9PSA0MDQpIHtcbiAgICAgICAgICAgICAgICBsb2coJ0F1dGhlbnRpY2F0aW9uIGFuZCBwb3N0IHByZXZpZXdzIHdpbGwgc29vbiBiZSBpbmNvbXBhdGlibGUgd2l0aCAnICtcbiAgICAgICAgICAgICAgICAgICAgJ3lvdXIgdmVyc2lvbiBvZiB0aGUgRmF1c3RXUCBwbHVnaW4uIFBsZWFzZSB1cGRhdGUgdG8gdGhlIGxhdGVzdCcgK1xuICAgICAgICAgICAgICAgICAgICAnIHZlcnNpb24uJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGVycm9yOiB0cnVlLFxuICAgICAgICAgICAgICAgIHJlc3BvbnNlLFxuICAgICAgICAgICAgICAgIHJlc3VsdCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1tb2R1bGUtYm91bmRhcnktdHlwZXNcbiAgICBpc09BdXRoVG9rZW5zKHZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGNhc3RlZFZhbHVlID0gdmFsdWU7XG4gICAgICAgIHJldHVybiAoIWlzTmlsKGNhc3RlZFZhbHVlKSAmJlxuICAgICAgICAgICAgaXNTdHJpbmcoY2FzdGVkVmFsdWUuYWNjZXNzVG9rZW4pICYmXG4gICAgICAgICAgICBpc1N0cmluZyhjYXN0ZWRWYWx1ZS5yZWZyZXNoVG9rZW4pICYmXG4gICAgICAgICAgICBpc051bWJlcihjYXN0ZWRWYWx1ZS5hY2Nlc3NUb2tlbkV4cGlyYXRpb24pICYmXG4gICAgICAgICAgICBpc051bWJlcihjYXN0ZWRWYWx1ZS5yZWZyZXNoVG9rZW5FeHBpcmF0aW9uKSk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/@faustjs/core/dist/mjs/server/auth/token.js\n");

/***/ })

}]);